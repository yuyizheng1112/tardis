<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Line Interaction Treatments &mdash; tardis</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Estimators and Convergence" href="../est_and_conv/index.html" />
    <link rel="prev" title="Packet Propagation" href="propagation.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> tardis
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/quickstart.html">Quickstart for TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/grid/TardisGridTutorial.html">TARDIS Grid Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Monte Carlo Iteration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basicprinciples.html">Monte Carlo Radiative Transfer - Basic Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="initialization.html">Energy Packet Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="propagation.html">Packet Propagation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Line Interaction Treatments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#resonant-scattering">Resonant Scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#downbranching">Downbranching</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macro-atom-scheme">Macro Atom Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparison">Comparison</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../est_and_conv/index.html">Estimators and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">Spectrum Generation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research with TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../research/index.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Team &amp; Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../team_and_governance/index.html">Team and Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sponsors.html">Sponsors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Development Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">tardis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zreferences.html">TARDIS Papers and useful References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Outdated</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../outdated/index.html">Outdated Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Monte Carlo Iteration</a> &raquo;</li>
      <li>Line Interaction Treatments</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/physics/montecarlo/lineinteraction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="line-interaction-treatments">
<span id="lineinteraction"></span><h1>Line Interaction Treatments<a class="headerlink" href="#line-interaction-treatments" title="Permalink to this headline">Â¶</a></h1>
<p>TARDIS currently offers different ways to handle line interactions, which may be
activated via the <a class="reference internal" href="../../zreferences.html#term-YAML"><span class="xref std std-term">YAML</span></a> configuration file. Independently of the chosen
treatment, a number of steps are always carried out when a Monte Carlo packet
performs a line interaction. Since TARDIS adopts the indivisible energy packet
formalism (see <a class="reference internal" href="initialization.html#initialization"><span class="std std-ref">Energy Packets</span></a>), the packet will have the
same energy in the co-moving frame after (f for final) the line interaction as
before (i for initial). Thus, after accounting for the frame transformations,</p>
<div class="math notranslate nohighlight">
\[\varepsilon_f = \varepsilon_i \frac{1 - \beta \mu_i}{1 - \beta \mu_f}\]</div>
<p>holds. Also, TARDIS treats that the re-emission of the line interaction
as an isotropic process. Thus,</p>
<div class="math notranslate nohighlight">
\[\mu_f = 2 z - 1.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the Sobolev theory, the re-emission direction is given by the so-called
Sobolev escape fraction, with is in general non-isotropic. However, in the
special case of homologous expansion, isotropy is retained.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Strictly speaking, the re-mission process occurs in the local co-moving
frame. Thus, the so called angle aberration effect should be taken into
account when transforming into the lab frame. However, TARDIS, currently
neglects this effect.</p>
</div>
<p>Essentially, the different line interaction treatments only determine how the
frequency of the packet after the line interaction is determined.</p>
<div class="section" id="resonant-scattering">
<h2>Resonant Scattering<a class="headerlink" href="#resonant-scattering" title="Permalink to this headline">Â¶</a></h2>
<p>The simplest line interaction mode assumes that all interactions with atomic
line transitions occur resonantly. This implies that in the co-moving frame the
emergent packet frequency is equal to the incident one. Again accounting for
the Doppler factors due to the frame transformations between co-moving and lab
frame, the post-interaction frequency is given by</p>
<div class="math notranslate nohighlight">
\[\nu_f  = \nu_i \frac{1 - \beta \mu_i}{1 - \beta \mu_f}\]</div>
</div>
<div class="section" id="downbranching">
<h2>Downbranching<a class="headerlink" href="#downbranching" title="Permalink to this headline">Â¶</a></h2>
<p>The so-called downbranching scheme, introduced by <span id="id1">[<a class="reference internal" href="../../zreferences.html#id25" title="L. B. Lucy. Improved Monte Carlo techniques for the spectral synthesis of supernovae. Astronomy and Astrophysics, 345:211-220, May 1999.">Lucy99b</a>]</span>, is an
elegant approach to approximately account for fluorescence effects. In this
scheme, the packet is not re-emitted in the same transitions as it was absorbed
in. Instead, it now can emerge from any line transition linking the activated
upper energy level to a lower one. For any specific line interaction event, the
re-emission channel is probabilistically selected according to the branching
ratios of the different allowed de-excitation transitions. For more details
about the downbranching scheme, we refer to <span id="id2">[<a class="reference internal" href="../../zreferences.html#id25" title="L. B. Lucy. Improved Monte Carlo techniques for the spectral synthesis of supernovae. Astronomy and Astrophysics, 345:211-220, May 1999.">Lucy99b</a>]</span> and
<span id="id3">[<a class="reference internal" href="../../zreferences.html#id19" title="W. E. Kerzendorf and S. A. Sim. A spectral synthesis code for rapid modelling of supernovae. Monthly Notices of the RAS, 440:387-404, May 2014. arXiv:1401.5469, doi:10.1093/mnras/stu055.">KerzendorfSim14</a>]</span>.</p>
</div>
<div class="section" id="macro-atom-scheme">
<h2>Macro Atom Scheme<a class="headerlink" href="#macro-atom-scheme" title="Permalink to this headline">Â¶</a></h2>
<p>Finally, as the most sophisticated line interaction treatment, a simplified
version of the Macro Atom scheme of <span id="id4">[<a class="reference internal" href="../../zreferences.html#id23" title="L. B. Lucy. Monte Carlo transition probabilities. Astronomy and Astrophysics, 384:725-735, March 2002. arXiv:arXiv:astro-ph/0107377, doi:10.1051/0004-6361:20011756.">Lucy02</a>]</span> and <span id="id5">[<a class="reference internal" href="../../zreferences.html#id22" title="L. B. Lucy. Monte Carlo transition probabilities. II. Astronomy and Astrophysics, 403:261-275, May 2003. arXiv:arXiv:astro-ph/0303202, doi:10.1051/0004-6361:20030357.">Lucy03</a>]</span> is
implemented in TARDIS. This approach provides a more accurate representation of
fluorescence processes and multi-line effects. Once a Monte Carlo packet is
absorbed in a certain line transition (macro atom activation), an arbitrary
number of internal jumps up and downwards may be performed. One may think of
them as changing the energy level which is excited. At any point during this
process, there is the chance that the internal jump procedure terminates and
that the packet is re-emitted in a transition linking the currently excited
upper energy level to a lower one (macro atom deactivation). Again, all
involved processes are governed by probabilities reflecting the different line
transition strengths, radiative emission and absorption processes. More details
about the implementation of the Macro Atom scheme in TARDIS is provided
<a class="reference internal" href="../setup/plasma/macroatom.html#macroatom"><span class="std std-ref">here</span></a>. For more background information and
an in-depth derivation of the scheme, we refer to <span id="id6">[<a class="reference internal" href="../../zreferences.html#id23" title="L. B. Lucy. Monte Carlo transition probabilities. Astronomy and Astrophysics, 384:725-735, March 2002. arXiv:arXiv:astro-ph/0107377, doi:10.1051/0004-6361:20011756.">Lucy02</a>]</span> and
<span id="id7">[<a class="reference internal" href="../../zreferences.html#id22" title="L. B. Lucy. Monte Carlo transition probabilities. II. Astronomy and Astrophysics, 403:261-275, May 2003. arXiv:arXiv:astro-ph/0303202, doi:10.1051/0004-6361:20030357.">Lucy03</a>]</span>.</p>
</div>
<div class="section" id="comparison">
<h2>Comparison<a class="headerlink" href="#comparison" title="Permalink to this headline">Â¶</a></h2>
<p>The different levels of sophistication are illustrated in the following plot,
taken from <span id="id8">[<a class="reference internal" href="../../zreferences.html#id19" title="W. E. Kerzendorf and S. A. Sim. A spectral synthesis code for rapid modelling of supernovae. Monthly Notices of the RAS, 440:387-404, May 2014. arXiv:1401.5469, doi:10.1093/mnras/stu055.">KerzendorfSim14</a>]</span> and showing the incident wavelength versus the
emergent wavelength of Monte Carlo packets in line interactions. The left panel
shows the situation in the resonant scatter mode, the middle one for the
downbranching scheme and the right one the macro atom results.</p>
<a class="reference internal image-reference" href="../../_images/scatter_downbranch_ma.png"><img alt="../../_images/scatter_downbranch_ma.png" src="../../_images/scatter_downbranch_ma.png" style="width: 700px;" /></a>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="propagation.html" class="btn btn-neutral float-left" title="Packet Propagation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../est_and_conv/index.html" class="btn btn-neutral float-right" title="Estimators and Convergence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2021, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 26 Sep 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>