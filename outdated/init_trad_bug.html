<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Initial_t_rad Bug &mdash; tardis</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/tardis_logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extending Pandas DataFrame Class" href="isotope_pd_subclass.html" />
    <link rel="prev" title="Outdated Installation FAQs" href="old_install.html" />
    <link href="../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> tardis
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/quickstart.html">Quickstart for TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../io/configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/output/index.html">Additional Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/grid/TardisGridTutorial.html">TARDIS Grid Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../physics/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/est_and_conv/index.html">Estimators and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/spectrum/index.html">Spectrum Generation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research with TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../research/index.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Team &amp; Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../team_and_governance/index.html">Team and Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sponsors.html">Sponsors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Development Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">tardis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zreferences.html">TARDIS Papers and useful References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Outdated</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Outdated Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="commandline.html">Running TARDIS in the commandline</a></li>
<li class="toctree-l2"><a class="reference internal" href="old_gui.html">Old Graphical User Interface (Outdated)</a></li>
<li class="toctree-l2"><a class="reference internal" href="openmp.html">Parallel execution with OpenMP</a></li>
<li class="toctree-l2"><a class="reference internal" href="old_install.html">Outdated Installation FAQs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Initial_t_rad Bug</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Density-and-Abundance-test-files">Density and Abundance test files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#No-initial_t_rad">No initial_t_rad</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Debugging">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Debugging-No-initial_t_radiative-run-to-compare-with-Yes-initial_t_radiative-run">Debugging No initial_t_radiative run to compare with Yes initial_t_radiative run</a></li>
<li class="toctree-l3"><a class="reference internal" href="#IMPORTANT:">IMPORTANT:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Debugging-Yes-initial_t_radiative-run">Debugging Yes initial_t_radiative run</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">IMPORTANT:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Checking-model.t_radiative-initialization-when-YES-initial_t_rad">Checking model.t_radiative initialization when YES initial_t_rad</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#len(model.t_radiative)-=-6-when-YES-initial_t_rad">len(model.t_radiative) = 6 when YES initial_t_rad</a></li>
<li class="toctree-l4"><a class="reference internal" href="#len(model.t_radiative)-=-5-when-NO-initial_t_rad">len(model.t_radiative) = 5 when NO initial_t_rad</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Checking-self._t_radiative-initialization-when-NO-initial_t_rad-at-line-108">Checking self._t_radiative initialization when NO initial_t_rad at line 108</a></li>
<li class="toctree-l3"><a class="reference internal" href="#CODE-CHANGE:">CODE CHANGE:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="isotope_pd_subclass.html">Extending Pandas DataFrame Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrator.html">API example for the formal integral</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_formal_integral.html">Spectral Synthesis with the Formal Integral Method</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Outdated Documentation</a> &raquo;</li>
      <li>Initial_t_rad Bug</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/outdated/init_trad_bug.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<style>
    .launch-btn {
        background-color: #2980B9;
        border: none;
        border-radius: 4px;
        color: #fcfcfc;
        font-family: inherit;
        text-decoration: none;
        padding: 3px 8px;
        letter-spacing: 0.03em;
        display: inline-block;
        line-height: 1.5em;
    }

    .launch-btn:hover {
        background-color: #1b6391;
        color: #fcfcfc;
    }

    .launch-btn:visited {
        color: #fcfcfc;
    }

    .note-p {
        margin-bottom: 0.4em;
        line-height: 2em;
    }
</style>

<div class="admonition note">
<p class="note-p">You can interact with this notebook online: <a href="https://mybinder.org/v2/gh/tardis-sn/tardis/HEAD?filepath=docs/outdated/init_trad_bug.ipynb" class="launch-btn" target="_blank" rel="noopener noreferrer">Launch interactive version</a></p>
</div><div class="section" id="Initial_t_rad-Bug">
<h1>Initial_t_rad Bug<a class="headerlink" href="#Initial_t_rad-Bug" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this notebook is to demonstrate the bug associated with setting the initial_t_rad tardis.plasma property.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pwd</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;/Users/marcwilliamson/src/dev/tardis/docs/notebooks&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">tardis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/anaconda2/envs/tardis/lib/python3.6/site-packages/tqdm/autonotebook/__init__.py:14: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)
  &#34; (e.g. in jupyter console)&#34;, TqdmExperimentalWarning)
</pre></div></div>
</div>
<div class="section" id="Density-and-Abundance-test-files">
<h2>Density and Abundance test files<a class="headerlink" href="#Density-and-Abundance-test-files" title="Permalink to this headline">¶</a></h2>
<p>Below are the density and abundance data from the test files used for demonstrating this bug.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">density_dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data/density.txt&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">abund_dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data/abund.dat&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">density_dat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">abund_dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0.00000000e+00 2.90000000e+03 4.28253781e-16]
 [1.00000000e+00 3.00000000e+03 4.12668886e-16]
 [2.00000000e+00 3.10000000e+03 3.94940562e-16]
 [3.00000000e+00 3.20000000e+03 3.80047743e-16]
 [4.00000000e+00 3.30000000e+03 3.63720829e-16]
 [5.00000000e+00 3.40000000e+03 3.53372945e-16]
 [6.00000000e+00 3.50000000e+03 3.46148955e-16]
 [7.00000000e+00 3.60000000e+03 3.37683976e-16]
 [8.00000000e+00 3.70000000e+03 3.30780715e-16]
 [9.00000000e+00 3.80000000e+03 3.26689004e-16]
 [1.00000000e+01 3.90000000e+03 3.23089580e-16]]
[[0.  1. ]
 [0.1 0.9]
 [0.2 0.8]
 [0.3 0.7]
 [0.4 0.6]
 [0.5 0.5]
 [0.6 0.4]
 [0.7 0.3]
 [0.8 0.2]
 [0.9 0.1]]
</pre></div></div>
</div>
</div>
<div class="section" id="No-initial_t_rad">
<h2>No initial_t_rad<a class="headerlink" href="#No-initial_t_rad" title="Permalink to this headline">¶</a></h2>
<p>Below we run a simple tardis simulation where <code class="docutils literal notranslate"><span class="pre">initial_t_rad</span></code> is not set. The simulation has v_inner_boundary = 3350 km/s and v_outer_boundary = 3750 km/s, both within the velocity range in the density file. The simulation runs fine.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">no_init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;data/config_no_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/importlib/_bootstrap.py:219: QAWarning: pyne.data is not yet QA compliant.
  return f(*args, **kwds)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/importlib/_bootstrap.py:219: QAWarning: pyne.material is not yet QA compliant.
  return f(*args, **kwds)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:394)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.plasma.standard_plasmas</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Reading Atomic Data from /Users/marcwilliamson/Research/TARDIS/tardis-refdata/atom_data/kurucz_cd23_chianti_H_He.h5 (<span class="ansi-bold">standard_plasmas.py</span>:74)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/IPython/core/interactiveshell.py:3296: PerformanceWarning: indexing past lexsort depth may impact performance.
  exec(code_obj, self.user_global_ns, self.user_ns)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Read Atom Data with UUID=6f7b09e887a311e7a06b246e96350010 and MD5=864f1753714343c41f99cb065710cace. (<span class="ansi-bold">base.py</span>:184)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Non provided atomic data: synpp_refs, photoionization_data (<span class="ansi-bold">base.py</span>:187)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/ion_population.py:63: FutureWarning:
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  partition_function.index].dropna())
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 1/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 7.60257e+41 erg / s Luminosity absorbed = 2.81189e+40 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                     t_rad   next_t_rad         w    next_w
        Shell
        0      9464.058312  9484.781155  0.439255  0.464482

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 9464.848 K -- next t_inner 12021.255 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/ion_population.py:63: FutureWarning:
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  partition_function.index].dropna())
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 2/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.60837e+42 erg / s Luminosity absorbed = 5.98006e+40 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                     t_rad    next_t_rad         w    next_w
        Shell
        0      9484.781155  12054.327238  0.464482  0.464327

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12021.255 K -- next t_inner 10497.194 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 3/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 9.75339e+41 erg / s Luminosity absorbed = 1.31663e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12054.327238  10542.291939  0.464327  0.509656

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 10497.194 K -- next t_inner 11770.965 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 4/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.41912e+42 erg / s Luminosity absorbed = 1.52432e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      10542.291939  11750.092484  0.509656  0.512801

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11770.965 K -- next t_inner 10942.574 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 5/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.11236e+42 erg / s Luminosity absorbed = 1.52914e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11750.092484  10938.987367  0.512801  0.525724

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 10942.574 K -- next t_inner 11489.809 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 6/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.29924e+42 erg / s Luminosity absorbed = 1.66012e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 1/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      10938.987367  11456.397166  0.525724  0.521184

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11489.809 K -- next t_inner 11163.104 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 7/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.16874e+42 erg / s Luminosity absorbed = 1.57467e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 2/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11456.397166  11225.829447  0.521184  0.516013

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11163.104 K -- next t_inner 11435.147 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 8/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.27029e+42 erg / s Luminosity absorbed = 1.71822e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 3/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w   next_w
        Shell
        0      11225.829447  11346.454712  0.516013  0.53765

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11435.147 K -- next t_inner 11235.867 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 9/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.20003e+42 erg / s Luminosity absorbed = 1.63905e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 4/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad        w    next_w
        Shell
        0      11346.454712  11219.677659  0.53765  0.529105

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11235.867 K -- next t_inner 11358.682 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 10/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.24727e+42 erg / s Luminosity absorbed = 1.71495e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 5/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad  next_t_rad         w   next_w
        Shell
        0      11219.677659  11296.3854  0.529105  0.53421

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11358.682 K -- next t_inner 11263.268 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 11/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.20567e+42 erg / s Luminosity absorbed = 1.59529e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 6/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                    t_rad    next_t_rad        w    next_w
        Shell
        0      11296.3854  11282.219084  0.53421  0.519595

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11263.268 K -- next t_inner 11359.683 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 12/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23796e+42 erg / s Luminosity absorbed = 1.69674e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 7/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11282.219084  11392.613803  0.519595  0.515397

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11359.683 K -- next t_inner 11306.524 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 13/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22796e+42 erg / s Luminosity absorbed = 1.72554e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11392.613803  11274.095909  0.515397  0.534286

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11306.524 K -- next t_inner 11299.342 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 14/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22087e+42 erg / s Luminosity absorbed = 1.68061e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 1/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11274.095909  11272.622074  0.534286  0.523052

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11299.342 K -- next t_inner 11324.894 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 15/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23507e+42 erg / s Luminosity absorbed = 1.67026e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 2/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w   next_w
        Shell
        0      11272.622074  11242.582689  0.523052  0.53977

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11324.894 K -- next t_inner 11285.077 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 16/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.21940e+42 erg / s Luminosity absorbed = 1.66346e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 3/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad        w    next_w
        Shell
        0      11242.582689  11290.452474  0.53977  0.522924

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11285.077 K -- next t_inner 11317.456 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 17/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22578e+42 erg / s Luminosity absorbed = 1.67022e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 4/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11290.452474  11301.322725  0.522924  0.528649

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11317.456 K -- next t_inner 11320.345 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 18/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22546e+42 erg / s Luminosity absorbed = 1.63272e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 5/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11301.322725  11321.012024  0.528649  0.522716

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11320.345 K -- next t_inner 11324.684 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 19/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22575e+42 erg / s Luminosity absorbed = 1.70322e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 6/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11321.012024  11372.823716  0.522716  0.516131

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11324.684 K -- next t_inner 11327.703 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 20/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23543e+42 erg / s Luminosity absorbed = 1.67596e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Simulation finished in 20 iterations and took 1.61 s (<span class="ansi-bold">base.py</span>:306)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">velocity</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$[3.35 \times 10^{8},~3.4 \times 10^{8},~3.5 \times 10^{8},~3.6 \times 10^{8},~3.7 \times 10^{8},~3.75 \times 10^{8}] \; \mathrm{\frac{cm}{s}}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">no_of_shells</span><span class="p">,</span> <span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">no_of_raw_shells</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5, 10)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;raw velocity: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">raw_velocity</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;raw velocity shape: &#39;</span><span class="p">,</span><span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">raw_velocity</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(v_boundary_inner, v_boundary_outer) = (</span><span class="si">%i</span><span class="s1">, </span><span class="si">%i</span><span class="s1">)&#39;</span><span class="o">%</span>
      <span class="p">(</span><span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">v_boundary_inner</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">v_boundary_outer</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v_boundary_inner_index: &#39;</span><span class="p">,</span> <span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">v_boundary_inner_index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v_boundary_outer_index: &#39;</span><span class="p">,</span> <span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">v_boundary_outer_index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t_rad&#39;</span><span class="p">,</span> <span class="n">no_init_trad</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">t_rad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
raw velocity:
 [2.9e+08 3.0e+08 3.1e+08 3.2e+08 3.3e+08 3.4e+08 3.5e+08 3.6e+08 3.7e+08
 3.8e+08 3.9e+08] cm / s
raw velocity shape:  (11,)
(v_boundary_inner, v_boundary_outer) = (3350, 3750)
v_boundary_inner_index:  4
v_boundary_outer_index:  10
t_rad [11372.82371614 11426.15383155 11420.35713928 11382.47864204
 11375.63115928] K
</pre></div></div>
</div>
</div>
<div class="section" id="Debugging">
<h2>Debugging<a class="headerlink" href="#Debugging" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%debug</span>
<span class="n">init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;data/config_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NOTE: Enter &#39;c&#39; at the ipdb&gt;  prompt to continue execution.
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; b tardis/plasma/properties/j_blues:34
Breakpoint 1 at /Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/j_blues.py:34
ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:368)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.plasma.standard_plasmas</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Reading Atomic Data from /Users/marcwilliamson/Research/TARDIS/tardis-refdata/atom_data/kurucz_cd23_chianti_H_He.h5 (<span class="ansi-bold">standard_plasmas.py</span>:74)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/bdb.py:434: PerformanceWarning: indexing past lexsort depth may impact performance.
  exec(cmd, globals, locals)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Read Atom Data with UUID=6f7b09e887a311e7a06b246e96350010 and MD5=864f1753714343c41f99cb065710cace. (<span class="ansi-bold">base.py</span>:184)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Non provided atomic data: synpp_refs, photoionization_data (<span class="ansi-bold">base.py</span>:187)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/j_blues.py</span>(34)<span class="ansi-cyan-fg">calculate</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     32 </span><span class="ansi-red-fg">    </span><span class="ansi-blue-fg">@</span>staticmethod
<span class="ansi-green-fg">     33 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> calculate<span class="ansi-blue-fg">(</span>lines<span class="ansi-blue-fg">,</span> nu<span class="ansi-blue-fg">,</span> t_rad<span class="ansi-blue-fg">,</span> w<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">--&gt; 34 </span><span class="ansi-red-fg">        </span>j_blues <span class="ansi-blue-fg">=</span> w <span class="ansi-blue-fg">*</span> intensity_black_body<span class="ansi-blue-fg">(</span>nu<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">[</span>np<span class="ansi-blue-fg">.</span>newaxis<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>T<span class="ansi-blue-fg">,</span> t_rad<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     35 </span><span class="ansi-red-fg">        j_blues = pd.DataFrame(j_blues, index=lines.index,
</span><span class="ansi-green-fg">     36 </span><span class="ansi-red-fg">                               columns=np.arange(len(t_rad)))
</span>
ipdb&gt; n
ValueError: operands could not be broadcast together with shapes (5,) (247,6)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/j_blues.py</span>(34)<span class="ansi-cyan-fg">calculate</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     32 </span><span class="ansi-red-fg">    </span><span class="ansi-blue-fg">@</span>staticmethod
<span class="ansi-green-fg">     33 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> calculate<span class="ansi-blue-fg">(</span>lines<span class="ansi-blue-fg">,</span> nu<span class="ansi-blue-fg">,</span> t_rad<span class="ansi-blue-fg">,</span> w<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">--&gt; 34 </span><span class="ansi-red-fg">        </span>j_blues <span class="ansi-blue-fg">=</span> w <span class="ansi-blue-fg">*</span> intensity_black_body<span class="ansi-blue-fg">(</span>nu<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">[</span>np<span class="ansi-blue-fg">.</span>newaxis<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>T<span class="ansi-blue-fg">,</span> t_rad<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     35 </span><span class="ansi-red-fg">        j_blues = pd.DataFrame(j_blues, index=lines.index,
</span><span class="ansi-green-fg">     36 </span><span class="ansi-red-fg">                               columns=np.arange(len(t_rad)))
</span>
ipdb&gt; restart
Restarting
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:368)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.plasma.standard_plasmas</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Reading Atomic Data from /Users/marcwilliamson/Research/TARDIS/tardis-refdata/atom_data/kurucz_cd23_chianti_H_He.h5 (<span class="ansi-bold">standard_plasmas.py</span>:74)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/bdb.py:434: PerformanceWarning: indexing past lexsort depth may impact performance.
  exec(cmd, globals, locals)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Read Atom Data with UUID=6f7b09e887a311e7a06b246e96350010 and MD5=864f1753714343c41f99cb065710cace. (<span class="ansi-bold">base.py</span>:184)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Non provided atomic data: synpp_refs, photoionization_data (<span class="ansi-bold">base.py</span>:187)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/j_blues.py</span>(34)<span class="ansi-cyan-fg">calculate</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     32 </span><span class="ansi-red-fg">    </span><span class="ansi-blue-fg">@</span>staticmethod
<span class="ansi-green-fg">     33 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">def</span> calculate<span class="ansi-blue-fg">(</span>lines<span class="ansi-blue-fg">,</span> nu<span class="ansi-blue-fg">,</span> t_rad<span class="ansi-blue-fg">,</span> w<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">--&gt; 34 </span><span class="ansi-red-fg">        </span>j_blues <span class="ansi-blue-fg">=</span> w <span class="ansi-blue-fg">*</span> intensity_black_body<span class="ansi-blue-fg">(</span>nu<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">[</span>np<span class="ansi-blue-fg">.</span>newaxis<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>T<span class="ansi-blue-fg">,</span> t_rad<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     35 </span><span class="ansi-red-fg">        j_blues = pd.DataFrame(j_blues, index=lines.index,
</span><span class="ansi-green-fg">     36 </span><span class="ansi-red-fg">                               columns=np.arange(len(t_rad)))
</span>
ipdb&gt; t_rad
array([11000., 11000., 11000., 11000., 11000., 11000.])
ipdb&gt; lines.shape
(247, 9)
ipdb&gt; intensity_black_body(nu.values[np.newaxis].T, t_rad)
array([[3.45300820e-23, 3.45300820e-23, 3.45300820e-23, 3.45300820e-23,
        3.45300820e-23, 3.45300820e-23],
       [3.45300820e-23, 3.45300820e-23, 3.45300820e-23, 3.45300820e-23,
        3.45300820e-23, 3.45300820e-23],
       [1.17024224e-22, 1.17024224e-22, 1.17024224e-22, 1.17024224e-22,
        1.17024224e-22, 1.17024224e-22],
       ...,
       [1.65889253e-10, 1.65889253e-10, 1.65889253e-10, 1.65889253e-10,
        1.65889253e-10, 1.65889253e-10],
       [1.65754663e-10, 1.65754663e-10, 1.65754663e-10, 1.65754663e-10,
        1.65754663e-10, 1.65754663e-10],
       [8.99221749e-11, 8.99221749e-11, 8.99221749e-11, 8.99221749e-11,
        8.99221749e-11, 8.99221749e-11]])
ipdb&gt; intensity_black_body(nu.values[np.newaxis].T, t_rad).shape
(247, 6)
ipdb&gt; lines.shape
(247, 9)
ipdb&gt; nu.shape
(247,)
ipdb&gt; restart
Restarting
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; b tardis/simulation/base:436
Breakpoint 2 at /Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py:436
ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:368)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py</span>(436)<span class="ansi-cyan-fg">from_config</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    434 </span><span class="ansi-red-fg">            </span>plasma <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;plasma&#39;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    435 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">2</span><span class="ansi-green-fg">-&gt; 436 </span><span class="ansi-red-fg">            plasma = assemble_plasma(config, model,
</span><span class="ansi-green-fg">    437 </span><span class="ansi-red-fg">                                     atom_data=kwargs.get(&#39;atom_data&#39;, None))
</span><span class="ansi-green-fg">    438 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">&#39;runner&#39;</span> <span class="ansi-green-fg">in</span> kwargs<span class="ansi-blue-fg">:</span>

ipdb&gt; model
&lt;tardis.model.base.Radial1DModel object at 0x12e05a940&gt;
ipdb&gt; model.trad
*** AttributeError: &#39;Radial1DModel&#39; object has no attribute &#39;trad&#39;
ipdb&gt; model.t_rad
&lt;Quantity [11000., 11000., 11000., 11000., 11000., 11000.] K&gt;
ipdb&gt; model.velocity
&lt;Quantity [3.35e+08, 3.40e+08, 3.50e+08, 3.60e+08, 3.70e+08, 3.75e+08] cm / s&gt;
ipdb&gt; b tardis/model/base:334
Breakpoint 3 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:334
ipdb&gt; restart
Restarting
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; c
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(334)<span class="ansi-cyan-fg">from_config</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    332 </span><span class="ansi-red-fg">            </span>t_radiative <span class="ansi-blue-fg">=</span> temperature
<span class="ansi-green-fg">    333 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">elif</span> config<span class="ansi-blue-fg">.</span>plasma<span class="ansi-blue-fg">.</span>initial_t_rad <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">0</span> <span class="ansi-blue-fg">*</span> u<span class="ansi-blue-fg">.</span>K<span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">3</span><span class="ansi-green-fg">-&gt; 334 </span><span class="ansi-red-fg">            </span>t_radiative <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>ones<span class="ansi-blue-fg">(</span>no_of_shells<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">*</span> config<span class="ansi-blue-fg">.</span>plasma<span class="ansi-blue-fg">.</span>initial_t_rad
<span class="ansi-green-fg">    335 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    336 </span><span class="ansi-red-fg">            </span>t_radiative <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>

ipdb&gt; n
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(338)<span class="ansi-cyan-fg">from_config</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    336 </span><span class="ansi-red-fg">            </span>t_radiative <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">    337 </span>
<span class="ansi-green-fg">--&gt; 338 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> config<span class="ansi-blue-fg">.</span>plasma<span class="ansi-blue-fg">.</span>initial_t_inner <span class="ansi-blue-fg">&lt;</span> <span class="ansi-cyan-fg">0.0</span> <span class="ansi-blue-fg">*</span> u<span class="ansi-blue-fg">.</span>K<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    339 </span><span class="ansi-red-fg">            </span>luminosity_requested <span class="ansi-blue-fg">=</span> config<span class="ansi-blue-fg">.</span>supernova<span class="ansi-blue-fg">.</span>luminosity_requested
<span class="ansi-green-fg">    340 </span><span class="ansi-red-fg">            </span>t_inner <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>

ipdb&gt; t_radiative
&lt;Quantity [11000., 11000., 11000., 11000., 11000., 11000., 11000., 11000.,
           11000., 11000.] K&gt;
ipdb&gt; b tardis/model/base:107
Breakpoint 4 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:107
ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:368)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(107)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    105 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    106 </span><span class="ansi-red-fg">            </span><span class="ansi-red-fg">#self._t_radiative = t_radiative[self.v_boundary_inner_index + 0:self.v_boundary_outer_index-1]</span>
<span class="ansi-red-intense-fg ansi-bold">4</span><span class="ansi-green-fg">-&gt; 107 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>_t_radiative <span class="ansi-blue-fg">=</span> t_radiative
<span class="ansi-green-fg">    108 </span>
<span class="ansi-green-fg">    109 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> dilution_factor <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

ipdb&gt; t_radiative
&lt;Quantity [11000., 11000., 11000., 11000., 11000., 11000., 11000., 11000.,
           11000., 11000.] K&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;data/config_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:394)
[<span class="ansi-bold">tardis.plasma.standard_plasmas</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Reading Atomic Data from /Users/marcwilliamson/Research/TARDIS/tardis-refdata/atom_data/kurucz_cd23_chianti_H_He.h5 (<span class="ansi-bold">standard_plasmas.py</span>:74)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/IPython/core/interactiveshell.py:3296: PerformanceWarning: indexing past lexsort depth may impact performance.
  exec(code_obj, self.user_global_ns, self.user_ns)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Read Atom Data with UUID=6f7b09e887a311e7a06b246e96350010 and MD5=864f1753714343c41f99cb065710cace. (<span class="ansi-bold">base.py</span>:184)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Non provided atomic data: synpp_refs, photoionization_data (<span class="ansi-bold">base.py</span>:187)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/ion_population.py:63: FutureWarning:
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  partition_function.index].dropna())
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 1/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 5.98252e+41 erg / s Luminosity absorbed = 1.50141e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                 t_rad    next_t_rad         w    next_w
        Shell
        0      11000.0  10177.195287  0.408333  0.538077
        5      11000.0  10160.603522  0.229156  0.282716

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 10172.718 K -- next t_inner 14565.035 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 2/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.82691e+42 erg / s Luminosity absorbed = 2.82152e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      10177.195287  14593.630626  0.538077  0.496563
        5      10160.603522  14511.556871  0.282716  0.275395

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 14565.035 K -- next t_inner 11933.532 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 3/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 9.71423e+41 erg / s Luminosity absorbed = 2.55207e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      14593.630626  11959.523175  0.496563  0.536576
        5      14511.556871  11863.444513  0.275395  0.288444

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11933.532 K -- next t_inner 13408.534 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 4/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.34841e+42 erg / s Luminosity absorbed = 3.56350e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11959.523175  13397.442807  0.536576  0.545853
        5      11863.444513  13434.561796  0.288444  0.279834

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 13408.534 K -- next t_inner 12787.534 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 5/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.18228e+42 erg / s Luminosity absorbed = 3.17468e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      13397.442807  12761.259654  0.545853  0.549926
        5      13434.561796  12694.451547  0.279834  0.291458

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12787.534 K -- next t_inner 13023.975 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 6/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.24451e+42 erg / s Luminosity absorbed = 3.27235e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 1/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12761.259654  12957.006442  0.549926  0.556939
        5      12694.451547  12962.669431  0.291458  0.289348

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 13023.975 K -- next t_inner 12928.870 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 7/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.20889e+42 erg / s Luminosity absorbed = 3.17537e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 2/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12957.006442  13011.562529  0.556939  0.528909
        5      12962.669431  12911.385086  0.289348  0.287062

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12928.870 K -- next t_inner 13022.158 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 8/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23931e+42 erg / s Luminosity absorbed = 3.40055e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 3/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      13011.562529  12935.144806  0.528909  0.559823
        5      12911.385086  12870.837942  0.287062  0.295395

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 13022.158 K -- next t_inner 12954.144 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 9/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22083e+42 erg / s Luminosity absorbed = 3.29617e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 4/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12935.144806  12952.771269  0.559823  0.547270
        5      12870.837942  12869.711846  0.295395  0.288923

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12954.144 K -- next t_inner 12983.662 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 10/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23857e+42 erg / s Luminosity absorbed = 3.31449e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 5/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12952.771269  12942.126028  0.547270  0.550270
        5      12869.711846  12884.875415  0.288923  0.292539

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12983.662 K -- next t_inner 12919.755 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 11/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.21056e+42 erg / s Luminosity absorbed = 3.23893e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 6/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12942.126028  12918.966676  0.550270  0.544292
        5      12884.875415  12886.798065  0.292539  0.286558

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12919.755 K -- next t_inner 13004.019 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 12/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22616e+42 erg / s Luminosity absorbed = 3.33203e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 7/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12918.966676  13031.662542  0.544292  0.538490
        5      12886.798065  13010.109337  0.286558  0.282402

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 13004.019 K -- next t_inner 13005.291 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 13/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.24894e+42 erg / s Luminosity absorbed = 3.24574e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 8/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      13031.662542  12990.586647  0.538490  0.548625
        5      13010.109337  13019.214949  0.282402  0.283709

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 13005.291 K -- next t_inner 12887.418 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 14/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.21057e+42 erg / s Luminosity absorbed = 3.20036e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 9/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12990.586647  12897.972400  0.548625  0.540328
        5      13019.214949  12826.318536  0.283709  0.288119

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12887.418 K -- next t_inner 12971.403 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 15/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23054e+42 erg / s Luminosity absorbed = 3.31427e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12897.972400  12860.146712  0.540328  0.564957
        5      12826.318536  12875.961642  0.288119  0.291152

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12971.403 K -- next t_inner 12949.598 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 16/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22535e+42 erg / s Luminosity absorbed = 3.21967e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 1/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12860.146712  12941.966455  0.564957  0.546565
        5      12875.961642  12851.925013  0.291152  0.290785

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12949.598 K -- next t_inner 12955.177 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 17/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.21929e+42 erg / s Luminosity absorbed = 3.29847e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 2/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12941.966455  12925.141575  0.546565  0.554237
        5      12851.925013  12885.285408  0.290785  0.289662

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12955.177 K -- next t_inner 12992.898 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 18/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22332e+42 erg / s Luminosity absorbed = 3.27060e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 3/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12925.141575  13004.854945  0.554237  0.543770
        5      12885.285408  13027.690260  0.289662  0.281762

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12992.898 K -- next t_inner 13009.263 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 19/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22932e+42 erg / s Luminosity absorbed = 3.29206e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 4/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      13004.854945  13056.576129  0.543770  0.537160
        5      13027.690260  13038.177112  0.281762  0.277439

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 13009.263 K -- next t_inner 12993.824 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 20/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23821e+42 erg / s Luminosity absorbed = 3.24957e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Simulation finished in 20 iterations and took 2.23 s (<span class="ansi-bold">base.py</span>:306)
</pre></div></div>
</div>
</div>
<div class="section" id="id1">
<h2>Debugging<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Debugging-No-initial_t_radiative-run-to-compare-with-Yes-initial_t_radiative-run">
<h2>Debugging No initial_t_radiative run to compare with Yes initial_t_radiative run<a class="headerlink" href="#Debugging-No-initial_t_radiative-run-to-compare-with-Yes-initial_t_radiative-run" title="Permalink to this headline">¶</a></h2>
<p>We place two breakpoints:</p>
<p>break 1. tardis/base:37 –&gt; Stops in the run_tardis() function when the simulation is initialized.</p>
<p>break 2. tardis/simulation/base:436 –&gt; Stops after the Radial1DModel has been built from the config file, but before the plasma has been initialized.</p>
</div>
<div class="section" id="IMPORTANT:">
<h2>IMPORTANT:<a class="headerlink" href="#IMPORTANT:" title="Permalink to this headline">¶</a></h2>
<p>We check the model.t_radiative property INSIDE the assemble_plasma function. Notice that it has len(model.t_radiative) = model.no_of_shells = 5</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%debug</span>
<span class="n">no_init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;config_no_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NOTE: Enter &#39;c&#39; at the ipdb&gt;  prompt to continue execution.
None
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; b tardis/base:37
Breakpoint 1 at /Users/marcwilliamson/src/dev/tardis/tardis/base.py:37
ipdb&gt; b tardis/simulation/base:436
Breakpoint 2 at /Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py:436
ipdb&gt; c
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/base.py</span>(37)<span class="ansi-cyan-fg">run_tardis</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     35 </span><span class="ansi-red-fg">        </span>tardis_config <span class="ansi-blue-fg">=</span> Configuration<span class="ansi-blue-fg">.</span>from_config_dict<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     36 </span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">--&gt; 37 </span><span class="ansi-red-fg">    </span>simulation <span class="ansi-blue-fg">=</span> Simulation<span class="ansi-blue-fg">.</span>from_config<span class="ansi-blue-fg">(</span>tardis_config<span class="ansi-blue-fg">,</span> atom_data<span class="ansi-blue-fg">=</span>atom_data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     38 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> simulation_callbacks<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     39 </span><span class="ansi-red-fg">        </span>simulation<span class="ansi-blue-fg">.</span>add_callback<span class="ansi-blue-fg">(</span>cb<span class="ansi-blue-fg">)</span>

ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:367)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py</span>(436)<span class="ansi-cyan-fg">from_config</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    434 </span><span class="ansi-red-fg">            </span>plasma <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;plasma&#39;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    435 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">2</span><span class="ansi-green-fg">-&gt; 436 </span><span class="ansi-red-fg">            plasma = assemble_plasma(config, model,
</span><span class="ansi-green-fg">    437 </span><span class="ansi-red-fg">                                     atom_data=kwargs.get(&#39;atom_data&#39;, None))
</span><span class="ansi-green-fg">    438 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">&#39;runner&#39;</span> <span class="ansi-green-fg">in</span> kwargs<span class="ansi-blue-fg">:</span>

ipdb&gt; s
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py</span>(437)<span class="ansi-cyan-fg">from_config</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    435 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">2</span><span class="ansi-green-fg">   436 </span><span class="ansi-red-fg">            plasma = assemble_plasma(config, model,
</span><span class="ansi-green-fg">--&gt; 437 </span><span class="ansi-red-fg">                                     atom_data=kwargs.get(&#39;atom_data&#39;, None))
</span><span class="ansi-green-fg">    438 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">&#39;runner&#39;</span> <span class="ansi-green-fg">in</span> kwargs<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    439 </span><span class="ansi-red-fg">            </span>runner <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;runner&#39;</span><span class="ansi-blue-fg">]</span>

ipdb&gt; s
--Call--
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/plasma/standard_plasmas.py</span>(33)<span class="ansi-cyan-fg">assemble_plasma</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     31 </span>
<span class="ansi-green-fg">     32 </span>
<span class="ansi-green-fg">---&gt; 33 </span><span class="ansi-green-fg">def</span> assemble_plasma<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">,</span> atom_data<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     34 </span><span class="ansi-red-fg">    &#34;&#34;&#34;
</span><span class="ansi-green-fg">     35 </span><span class="ansi-red-fg">    </span>Create a BasePlasma instance <span class="ansi-green-fg">from</span> a Configuration object

ipdb&gt; n
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/plasma/standard_plasmas.py</span>(52)<span class="ansi-cyan-fg">assemble_plasma</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">    &#34;&#34;&#34;
</span><span class="ansi-green-fg">     51 </span><span class="ansi-red-fg">    </span><span class="ansi-red-fg"># Convert the nlte species list to a proper format.</span>
<span class="ansi-green-fg">---&gt; 52 </span><span class="ansi-red-fg">    nlte_species = [species_string_to_tuple(s) for s in
</span><span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                    config.plasma.nlte.species]
</span><span class="ansi-green-fg">     54 </span>

ipdb&gt; model.t_radiative
&lt;Quantity [9464.0583115 , 9461.69144847, 9458.53747203, 9455.38559759,
           9453.02306994] K&gt;
ipdb&gt; model.no_of_shells
5
ipdb&gt; len(model.t_radiative)==model.no_of_shells
True
ipdb&gt; exit
</pre></div></div>
</div>
</div>
<div class="section" id="Debugging-Yes-initial_t_radiative-run">
<h2>Debugging Yes initial_t_radiative run<a class="headerlink" href="#Debugging-Yes-initial_t_radiative-run" title="Permalink to this headline">¶</a></h2>
<p>We place the same two breakpoints as above:</p>
<p>break 1. tardis/base:37 –&gt; Stops in the run_tardis() function when the simulation is initialized.</p>
<p>break 2. tardis/simulation/base:436 –&gt; Stops after the Radial1DModel has been built from the config file, but before the plasma has been initialized.</p>
</div>
<div class="section" id="id2">
<h2>IMPORTANT:<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>We check the model.t_radiative property INSIDE the assemble_plasma function. Notice that it has len(model.t_radiative) = 6 which is NOT EQUAL to model.no_of_shells = 5</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%debug</span>
<span class="n">init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;config_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NOTE: Enter &#39;c&#39; at the ipdb&gt;  prompt to continue execution.
None
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; b tardis/base:37
Breakpoint 1 at /Users/marcwilliamson/src/dev/tardis/tardis/base.py:37
ipdb&gt; b tardis/simulation/base:436
Breakpoint 2 at /Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py:436
ipdb&gt; c
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/base.py</span>(37)<span class="ansi-cyan-fg">run_tardis</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     35 </span><span class="ansi-red-fg">        </span>tardis_config <span class="ansi-blue-fg">=</span> Configuration<span class="ansi-blue-fg">.</span>from_config_dict<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     36 </span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">--&gt; 37 </span><span class="ansi-red-fg">    </span>simulation <span class="ansi-blue-fg">=</span> Simulation<span class="ansi-blue-fg">.</span>from_config<span class="ansi-blue-fg">(</span>tardis_config<span class="ansi-blue-fg">,</span> atom_data<span class="ansi-blue-fg">=</span>atom_data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     38 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> simulation_callbacks<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     39 </span><span class="ansi-red-fg">        </span>simulation<span class="ansi-blue-fg">.</span>add_callback<span class="ansi-blue-fg">(</span>cb<span class="ansi-blue-fg">)</span>

ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:367)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py</span>(436)<span class="ansi-cyan-fg">from_config</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    434 </span><span class="ansi-red-fg">            </span>plasma <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;plasma&#39;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">    435 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">2</span><span class="ansi-green-fg">-&gt; 436 </span><span class="ansi-red-fg">            plasma = assemble_plasma(config, model,
</span><span class="ansi-green-fg">    437 </span><span class="ansi-red-fg">                                     atom_data=kwargs.get(&#39;atom_data&#39;, None))
</span><span class="ansi-green-fg">    438 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">&#39;runner&#39;</span> <span class="ansi-green-fg">in</span> kwargs<span class="ansi-blue-fg">:</span>

ipdb&gt; s
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/simulation/base.py</span>(437)<span class="ansi-cyan-fg">from_config</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    435 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-red-intense-fg ansi-bold">2</span><span class="ansi-green-fg">   436 </span><span class="ansi-red-fg">            plasma = assemble_plasma(config, model,
</span><span class="ansi-green-fg">--&gt; 437 </span><span class="ansi-red-fg">                                     atom_data=kwargs.get(&#39;atom_data&#39;, None))
</span><span class="ansi-green-fg">    438 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">&#39;runner&#39;</span> <span class="ansi-green-fg">in</span> kwargs<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    439 </span><span class="ansi-red-fg">            </span>runner <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;runner&#39;</span><span class="ansi-blue-fg">]</span>

ipdb&gt; s
--Call--
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/plasma/standard_plasmas.py</span>(33)<span class="ansi-cyan-fg">assemble_plasma</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     31 </span>
<span class="ansi-green-fg">     32 </span>
<span class="ansi-green-fg">---&gt; 33 </span><span class="ansi-green-fg">def</span> assemble_plasma<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">,</span> atom_data<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     34 </span><span class="ansi-red-fg">    &#34;&#34;&#34;
</span><span class="ansi-green-fg">     35 </span><span class="ansi-red-fg">    </span>Create a BasePlasma instance <span class="ansi-green-fg">from</span> a Configuration object

ipdb&gt; n
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/plasma/standard_plasmas.py</span>(52)<span class="ansi-cyan-fg">assemble_plasma</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     50 </span><span class="ansi-red-fg">    &#34;&#34;&#34;
</span><span class="ansi-green-fg">     51 </span><span class="ansi-red-fg">    </span><span class="ansi-red-fg"># Convert the nlte species list to a proper format.</span>
<span class="ansi-green-fg">---&gt; 52 </span><span class="ansi-red-fg">    nlte_species = [species_string_to_tuple(s) for s in
</span><span class="ansi-green-fg">     53 </span><span class="ansi-red-fg">                    config.plasma.nlte.species]
</span><span class="ansi-green-fg">     54 </span>

ipdb&gt; model.t_radiative
&lt;Quantity [11000., 11000., 11000., 11000., 11000., 11000.] K&gt;
ipdb&gt; len(model.t_radiative) == model.no_of_shells
False
ipdb&gt; exit
</pre></div></div>
</div>
</div>
<div class="section" id="Checking-model.t_radiative-initialization-when-YES-initial_t_rad">
<h2>Checking model.t_radiative initialization when YES initial_t_rad<a class="headerlink" href="#Checking-model.t_radiative-initialization-when-YES-initial_t_rad" title="Permalink to this headline">¶</a></h2>
<p>In the above debugging blocks, we have identified the following discrepancy INSIDE assemble_plasma():</p>
<div class="section" id="len(model.t_radiative)-=-6-when-YES-initial_t_rad">
<h3>len(model.t_radiative) = 6 when YES initial_t_rad<a class="headerlink" href="#len(model.t_radiative)-=-6-when-YES-initial_t_rad" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="len(model.t_radiative)-=-5-when-NO-initial_t_rad">
<h3>len(model.t_radiative) = 5 when NO initial_t_rad<a class="headerlink" href="#len(model.t_radiative)-=-5-when-NO-initial_t_rad" title="Permalink to this headline">¶</a></h3>
<p>Therefore, we investigate in the following debugging block how model.t_radiative is initialized. We place a breakpoint at tardis/simulation/base:432 and step INSIDE the Radial1DModel initialization.</p>
<p>Breakpoints:</p>
<p>break 1. tardis/simulation/base:432 –&gt; Stops so that we can step INSIDE Radial1DModel initialization from_config().</p>
<p>break 2. tardis/model/base:330 –&gt; Where temperature is handled INSIDE Radial1DModel initialization from_config().</p>
<p>break 3. tardis/model/base:337 –&gt; <code class="docutils literal notranslate"><span class="pre">t_radiative</span></code> is initialized. It has the same length as <code class="docutils literal notranslate"><span class="pre">velocity</span></code> which is the raw velocities from the density file.</p>
<p>break 4. tardis/model/base:374 –&gt; init() for Radial1DModel is called. We check values of relevant variables.</p>
<p>break 5. tardis/model/base:76 –&gt; Stops at first line of Radial1DModel init() function.</p>
<p>break 6. tardis/model/base:101 –&gt; self._t_radiative is set.</p>
<p>break 7. tardis/model/base:140 –&gt; Stops at first line of self.t_radiative setter.</p>
<p>break 8. tardis/model/base:132 –&gt; Stops at first line of self.t_radiative getter.</p>
<p>break 9. tardis/model/base:108 –&gt; Stop right after self._t_radiative is set. NOTICE that neither the setter nor the getter was called. <strong>IMPORTANT:</strong> at line 108, we have len(self._t_radiative) = 10. <strong>TO DO:</strong> Check len(self._t_radiative) at line 108 in the NO initial_t_rad case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%debug</span>
<span class="n">init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;config_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NOTE: Enter &#39;c&#39; at the ipdb&gt;  prompt to continue execution.
None
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; b tardis/model/base:101
Breakpoint 1 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:101
ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:367)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(101)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     99 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>t_inner <span class="ansi-blue-fg">=</span> t_inner
<span class="ansi-green-fg">    100 </span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">-&gt; 101 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> t_radiative <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    102 </span><span class="ansi-red-fg">            </span>lambda_wien_inner <span class="ansi-blue-fg">=</span> constants<span class="ansi-blue-fg">.</span>b_wien <span class="ansi-blue-fg">/</span> self<span class="ansi-blue-fg">.</span>t_inner
<span class="ansi-green-fg">    103 </span><span class="ansi-red-fg">            self._t_radiative = constants.b_wien / (lambda_wien_inner * (
</span>
ipdb&gt; n
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(106)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    104 </span><span class="ansi-red-fg">                1 + (self.v_middle - self.v_boundary_inner) / constants.c))
</span><span class="ansi-green-fg">    105 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 106 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>_t_radiative <span class="ansi-blue-fg">=</span> t_radiative
<span class="ansi-green-fg">    107 </span>
<span class="ansi-green-fg">    108 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> dilution_factor <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

ipdb&gt; b tardis/model/base:108
Breakpoint 2 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:108
ipdb&gt; b tardis/model/base:140
Breakpoint 3 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:140
ipdb&gt; b tardis/model/base:132
Breakpoint 4 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:132
ipdb&gt; c
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(108)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    106 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>_t_radiative <span class="ansi-blue-fg">=</span> t_radiative
<span class="ansi-green-fg">    107 </span>
<span class="ansi-red-intense-fg ansi-bold">2</span><span class="ansi-green-fg">-&gt; 108 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> dilution_factor <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    109 </span><span class="ansi-red-fg">            self.dilution_factor = 0.5 * (1 - np.sqrt(
</span><span class="ansi-green-fg">    110 </span><span class="ansi-red-fg">                1 - (self.r_inner[0] ** 2 / self.r_middle ** 2).to(1).value))
</span>
ipdb&gt; self._t_radiative
&lt;Quantity [11000., 11000., 11000., 11000., 11000., 11000., 11000., 11000.,
           11000., 11000.] K&gt;
ipdb&gt; exit
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Checking-self._t_radiative-initialization-when-NO-initial_t_rad-at-line-108">
<h2>Checking self._t_radiative initialization when NO initial_t_rad at line 108<a class="headerlink" href="#Checking-self._t_radiative-initialization-when-NO-initial_t_rad-at-line-108" title="Permalink to this headline">¶</a></h2>
<p><strong>IMPORTANT:</strong> We find that len(self._t_radiative) = 5. This is a DISCREPANCY with the YES initial_t_rad case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%debug</span>
<span class="n">no_init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;config_no_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NOTE: Enter &#39;c&#39; at the ipdb&gt;  prompt to continue execution.
None
&gt; <span class="ansi-green-fg">&lt;string&gt;</span>(2)<span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

ipdb&gt; b tardis/model/base:101
Breakpoint 1 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:101
ipdb&gt; c
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:367)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(101)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     99 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>t_inner <span class="ansi-blue-fg">=</span> t_inner
<span class="ansi-green-fg">    100 </span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">-&gt; 101 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> t_radiative <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    102 </span><span class="ansi-red-fg">            </span>lambda_wien_inner <span class="ansi-blue-fg">=</span> constants<span class="ansi-blue-fg">.</span>b_wien <span class="ansi-blue-fg">/</span> self<span class="ansi-blue-fg">.</span>t_inner
<span class="ansi-green-fg">    103 </span><span class="ansi-red-fg">            self._t_radiative = constants.b_wien / (lambda_wien_inner * (
</span>
ipdb&gt; n
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(102)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    100 </span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">   101 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> t_radiative <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 102 </span><span class="ansi-red-fg">            </span>lambda_wien_inner <span class="ansi-blue-fg">=</span> constants<span class="ansi-blue-fg">.</span>b_wien <span class="ansi-blue-fg">/</span> self<span class="ansi-blue-fg">.</span>t_inner
<span class="ansi-green-fg">    103 </span><span class="ansi-red-fg">            self._t_radiative = constants.b_wien / (lambda_wien_inner * (
</span><span class="ansi-green-fg">    104 </span><span class="ansi-red-fg">                1 + (self.v_middle - self.v_boundary_inner) / constants.c))
</span>
ipdb&gt; n
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(103)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-fg">   101 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> t_radiative <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    102 </span><span class="ansi-red-fg">            </span>lambda_wien_inner <span class="ansi-blue-fg">=</span> constants<span class="ansi-blue-fg">.</span>b_wien <span class="ansi-blue-fg">/</span> self<span class="ansi-blue-fg">.</span>t_inner
<span class="ansi-green-fg">--&gt; 103 </span><span class="ansi-red-fg">            self._t_radiative = constants.b_wien / (lambda_wien_inner * (
</span><span class="ansi-green-fg">    104 </span><span class="ansi-red-fg">                1 + (self.v_middle - self.v_boundary_inner) / constants.c))
</span><span class="ansi-green-fg">    105 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>

ipdb&gt; l
<span class="ansi-green-intense-fg ansi-bold">     98 </span>        <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     99 </span>            self<span class="ansi-blue-fg">.</span>t_inner <span class="ansi-blue-fg">=</span> t_inner
<span class="ansi-green-intense-fg ansi-bold">    100 </span>
<span class="ansi-red-intense-fg ansi-bold">1</span><span class="ansi-green-intense-fg ansi-bold">   101 </span>        <span class="ansi-green-fg">if</span> t_radiative <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    102 </span>            lambda_wien_inner <span class="ansi-blue-fg">=</span> constants<span class="ansi-blue-fg">.</span>b_wien <span class="ansi-blue-fg">/</span> self<span class="ansi-blue-fg">.</span>t_inner
<span class="ansi-green-fg">--&gt; 103 </span><span class="ansi-red-fg">            self._t_radiative = constants.b_wien / (lambda_wien_inner * (
</span><span class="ansi-green-intense-fg ansi-bold">    104 </span>                1 + (self.v_middle - self.v_boundary_inner) / constants.c))
<span class="ansi-green-intense-fg ansi-bold">    105 </span>        <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    106 </span>            self<span class="ansi-blue-fg">.</span>_t_radiative <span class="ansi-blue-fg">=</span> t_radiative
<span class="ansi-green-intense-fg ansi-bold">    107 </span>
<span class="ansi-green-intense-fg ansi-bold">    108 </span>        <span class="ansi-green-fg">if</span> dilution_factor <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

ipdb&gt; b tardis/model/base:108
Breakpoint 2 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:108
ipdb&gt; b tardis/model/base:140
Breakpoint 3 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:140
ipdb&gt; b tardis/model/base:132
Breakpoint 4 at /Users/marcwilliamson/src/dev/tardis/tardis/model/base.py:132
ipdb&gt; c
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
&gt; <span class="ansi-green-fg">/Users/marcwilliamson/src/dev/tardis/tardis/model/base.py</span>(108)<span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">    106 </span><span class="ansi-red-fg">            </span>self<span class="ansi-blue-fg">.</span>_t_radiative <span class="ansi-blue-fg">=</span> t_radiative
<span class="ansi-green-fg">    107 </span>
<span class="ansi-red-intense-fg ansi-bold">2</span><span class="ansi-green-fg">-&gt; 108 </span><span class="ansi-red-fg">        </span><span class="ansi-green-fg">if</span> dilution_factor <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">    109 </span><span class="ansi-red-fg">            self.dilution_factor = 0.5 * (1 - np.sqrt(
</span><span class="ansi-green-fg">    110 </span><span class="ansi-red-fg">                1 - (self.r_inner[0] ** 2 / self.r_middle ** 2).to(1).value))
</span>
ipdb&gt; self._t_radiative
&lt;Quantity [9464.0583115 , 9461.69144847, 9458.53747203, 9455.38559759,
           9453.02306994] K&gt;
ipdb&gt; exit
</pre></div></div>
</div>
</div>
<div class="section" id="CODE-CHANGE:">
<h2>CODE CHANGE:<a class="headerlink" href="#CODE-CHANGE:" title="Permalink to this headline">¶</a></h2>
<p>We propose the following change to tardis/model/base:106</p>
<p><strong>Line 106 Before Change:</strong> <code class="docutils literal notranslate"><span class="pre">self._t_radiative</span> <span class="pre">=</span> <span class="pre">t_radiative</span></code></p>
<p><strong>Line 106 After Change:</strong> <code class="docutils literal notranslate"><span class="pre">self._t_radiative</span> <span class="pre">=</span> <span class="pre">t_radiative[1:1</span> <span class="pre">+</span> <span class="pre">self.no_of_shells]</span></code></p>
<p>t_radiative[0] corresponds to the temperature within the inner boundary, and so should be ignored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">init_trad</span> <span class="o">=</span> <span class="n">tardis</span><span class="o">.</span><span class="n">run_tardis</span><span class="p">(</span><span class="s1">&#39;config_init_trad.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/importlib/_bootstrap.py:219: QAWarning: pyne.data is not yet QA compliant.
  return f(*args, **kwds)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/importlib/_bootstrap.py:219: QAWarning: pyne.material is not yet QA compliant.
  return f(*args, **kwds)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.model.base   </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  Abundances have not been normalized to 1. - normalizing (<span class="ansi-bold">base.py</span>:367)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.plasma.standard_plasmas</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Reading Atomic Data from /Users/marcwilliamson/Research/TARDIS/tardis-refdata/atom_data/kurucz_cd23_chianti_H_He.h5 (<span class="ansi-bold">standard_plasmas.py</span>:74)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/IPython/core/interactiveshell.py:3296: PerformanceWarning: indexing past lexsort depth may impact performance.
  exec(code_obj, self.user_global_ns, self.user_ns)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Read Atom Data with UUID=6f7b09e887a311e7a06b246e96350010 and MD5=864f1753714343c41f99cb065710cace. (<span class="ansi-bold">base.py</span>:184)
[<span class="ansi-bold">tardis.io.atom_data.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Non provided atomic data: synpp_refs, photoionization_data (<span class="ansi-bold">base.py</span>:187)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/ion_population.py:63: FutureWarning:
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  partition_function.index].dropna())
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /anaconda2/envs/tardis/lib/python3.6/site-packages/astropy/units/quantity.py:1067: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError.
  AstropyDeprecationWarning)
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 1/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 6.99873e+41 erg / s Luminosity absorbed = 8.78774e+40 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                 t_rad   next_t_rad         w    next_w
        Shell
        0      11000.0  9480.001506  0.439255  0.516372

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 9464.848 K -- next t_inner 12529.122 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">py.warnings         </span>][<span class="ansi-yellow-intense-fg ansi-bold">WARNING</span>]  /Users/marcwilliamson/src/dev/tardis/tardis/plasma/properties/ion_population.py:63: FutureWarning:
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  partition_function.index].dropna())
 (<span class="ansi-bold">warnings.py</span>:99)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 2/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.81607e+42 erg / s Luminosity absorbed = 6.48628e+40 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                     t_rad    next_t_rad         w    next_w
        Shell
        0      9480.001506  12575.745392  0.516372  0.460796

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 12529.122 K -- next t_inner 10296.058 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 3/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 9.13387e+41 erg / s Luminosity absorbed = 1.26685e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      12575.745392  10311.711267  0.460796  0.518384

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 10296.058 K -- next t_inner 11930.539 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 4/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.49508e+42 erg / s Luminosity absorbed = 1.38767e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      10311.711267  11931.816104  0.518384  0.501568

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11930.539 K -- next t_inner 10805.487 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 5/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.06943e+42 erg / s Luminosity absorbed = 1.45352e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11931.816104  10806.647371  0.501568  0.521923

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 10805.487 K -- next t_inner 11571.347 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 6/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.33219e+42 erg / s Luminosity absorbed = 1.63948e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      10806.647371  11489.044309  0.521923  0.530125

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11571.347 K -- next t_inner 11102.402 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 7/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.14086e+42 erg / s Luminosity absorbed = 1.63206e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 1/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11489.044309  11163.609414  0.530125  0.515142

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11102.402 K -- next t_inner 11511.109 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 8/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.29957e+42 erg / s Luminosity absorbed = 1.72175e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 2/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11163.609414  11445.235326  0.515142  0.532271

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11511.109 K -- next t_inner 11182.357 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 9/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.18350e+42 erg / s Luminosity absorbed = 1.62089e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 3/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11445.235326  11107.763629  0.532271  0.539148

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11182.357 K -- next t_inner 11383.212 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 10/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.25575e+42 erg / s Luminosity absorbed = 1.74191e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 4/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11107.763629  11352.769902  0.539148  0.529162

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11383.212 K -- next t_inner 11249.393 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 11/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.20017e+42 erg / s Luminosity absorbed = 1.59589e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 5/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w   next_w
        Shell
        0      11352.769902  11267.543143  0.529162  0.52175

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11249.393 K -- next t_inner 11371.684 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 12/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.24238e+42 erg / s Luminosity absorbed = 1.69634e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 6/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad        w    next_w
        Shell
        0      11267.543143  11429.077116  0.52175  0.509304

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11371.684 K -- next t_inner 11298.313 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 13/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22572e+42 erg / s Luminosity absorbed = 1.70964e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 7/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11429.077116  11267.038005  0.509304  0.531961

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11298.313 K -- next t_inner 11301.467 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 14/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22675e+42 erg / s Luminosity absorbed = 1.64233e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 8/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11267.038005  11304.057113  0.531961  0.517281

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11301.467 K -- next t_inner 11299.844 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 15/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22841e+42 erg / s Luminosity absorbed = 1.63765e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 9/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11304.057113  11214.865131  0.517281  0.539284

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11299.844 K -- next t_inner 11290.591 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 16/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.21989e+42 erg / s Luminosity absorbed = 1.68821e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 10/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11214.865131  11251.931472  0.539284  0.531043

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11290.591 K -- next t_inner 11320.702 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 17/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22643e+42 erg / s Luminosity absorbed = 1.68202e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 11/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11251.931472  11227.712604  0.531043  0.545636

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11320.702 K -- next t_inner 11320.578 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 18/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22398e+42 erg / s Luminosity absorbed = 1.65226e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 12/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11227.712604  11322.952999  0.545636  0.520921

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11320.578 K -- next t_inner 11331.772 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 19/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.22450e+42 erg / s Luminosity absorbed = 1.74119e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Iteration converged 13/4 consecutive times. (<span class="ansi-bold">base.py</span>:194)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Plasma stratification:
                      t_rad    next_t_rad         w    next_w
        Shell
        0      11322.952999  11343.010318  0.520921  0.523692

 (<span class="ansi-bold">base.py</span>:348)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  t_inner 11331.772 K -- next t_inner 11340.566 K (<span class="ansi-bold">base.py</span>:350)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Starting iteration 20/20 (<span class="ansi-bold">base.py</span>:266)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Luminosity emitted = 1.23739e+42 erg / s Luminosity absorbed = 1.70270e+41 erg / s Luminosity requested = 1.22640e+42 erg / s (<span class="ansi-bold">base.py</span>:357)
[<span class="ansi-bold">tardis.simulation.base</span>][<span class="ansi-white-intense-fg ansi-bold">INFO</span>   ]  Simulation finished in 20 iterations and took 1.57 s (<span class="ansi-bold">base.py</span>:306)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([4, 5, 6, 7, 8])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1, 2, 3, 4, 5, 6, 7, 8])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="mi">2</span> <span class="ow">in</span> <span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
6
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">if</span> <span class="p">(</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">a</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="mf">3.5</span> <span class="ow">in</span> <span class="n">a</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">assert</span> <span class="mi">1</span><span class="o">==</span><span class="mf">1.2</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-15-43ea828a8ceb&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">assert</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">==</span><span class="ansi-cyan-fg">1.2</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;test&#34;</span>

<span class="ansi-red-fg">AssertionError</span>: test
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([4, 5, 6])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="old_install.html" class="btn btn-neutral float-left" title="Outdated Installation FAQs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="isotope_pd_subclass.html" class="btn btn-neutral float-right" title="Extending Pandas DataFrame Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2021, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 26 Sep 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>